% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/misc_functions.R
\name{fwrite_safe}
\alias{fwrite_safe}
\title{Write Data Table to File with Column Safety}
\usage{
fwrite_safe(x, file, append = TRUE, ...)
}
\arguments{
\item{x}{A data.table, data.frame, or matrix to write to file.}

\item{file}{Character string specifying the file path. If the file exists 
and \code{append = TRUE}, the function will ensure column compatibility.}

\item{append}{Logical. If \code{TRUE}, the data will be appended to an 
existing file. If \code{FALSE}, any existing file will be overwritten.
Default is \code{TRUE}.}

\item{...}{Additional arguments passed to \code{\link[data.table]{fwrite}}.}
}
\value{
Invisibly returns \code{TRUE} on success (same as \code{fwrite}).
}
\description{
A safer version of \code{\link[data.table]{fwrite}} that ensures column 
alignment when appending to existing files. This function automatically 
handles missing columns by adding them with NA values and reorders columns 
to match the existing file structure.
}
\details{
When \code{append = TRUE} and the target file exists, this function:
\itemize{
  \item Reads the column names from the existing file
  \item Throws an error if the new data contains columns not present in the original file
  \item Identifies missing columns in the new data and adds them with \code{NA} values
  \item Reorders columns to match the existing file structure
}

This prevents common errors that occur when appending data with different 
column structures to CSV files and ensures data integrity by not allowing
accidental column additions.
}
\examples{
\dontrun{
# Create initial data
dt1 <- data.table(a = 1:3, b = letters[1:3], c = 4:6)
fwrite_safe(dt1, "test.csv", append = FALSE)

# Append data with different column order
dt2 <- data.table(c = 7:8, b = letters[4:5], a = 9:10)
fwrite_safe(dt2, "test.csv", append = TRUE)  # Columns automatically aligned

# Append data with missing column
dt3 <- data.table(a = 11:12, b = letters[6:7])  # Missing column 'c'
fwrite_safe(dt3, "test.csv", append = TRUE)     # Column 'c' added with NA

# This would throw an error (extra column):
# dt4 <- data.table(a = 13:14, b = letters[8:9], d = 15:16)
# fwrite_safe(dt4, "test.csv", append = TRUE)  # Error: column 'd' not in original
}

}
\seealso{
\code{\link[data.table]{fwrite}}, \code{\link[data.table]{fread}}
}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/misc_functions.R
\name{read_parquet_dt}
\alias{read_parquet_dt}
\title{Read Parquet (partitioned dataset or single file) via Arrow, optionally filter/project, return data.table}
\usage{
read_parquet_dt(
  path,
  cols = NULL,
  filter = NULL,
  partitioning = "hive",
  as_data_table = TRUE
)
}
\arguments{
\item{path}{Character scalar (directory or file) OR character vector of parquet files.}

\item{cols}{Optional character vector of columns to keep (projection). NULL keeps all.}

\item{filter}{Optional row filter:
- an arrow::Expression, OR
- a function f(field) returning an Expression, where field is a helper:
    field("colname") returns arrow::field_ref("colname").
Example: filter = function(field) field("year") >= 2018 & field("sex") == "F"}

\item{partitioning}{Partitioning spec for datasets. Default "hive" is typical for col=value/ layouts.
If opening fails with this, the function automatically retries without partitioning.}

\item{as_data_table}{Logical; if TRUE returns data.table; if FALSE returns data.frame.}
}
\value{
data.table (default) or data.frame
}
\description{
Read Parquet (partitioned dataset or single file) via Arrow, optionally filter/project, return data.table
}
\examples{
# Partitioned dataset directory:
dt <- read_parquet_dt(
  "./inputs/exposure_distributions/smok_status_table",
  cols   = c("patid", "year", "smoke_status"),
  filter = function(field) field("year") >= 2018 & field("sex") == "F"
)

# Single file:
dt2 <- read_parquet_dt(
  "./inputs/exposure_distributions/smok_status_table.parquet",
  filter = function(field) field("age") >= 40
)
}
